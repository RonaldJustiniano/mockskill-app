<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_security_acl">
    <sys_security_acl action="INSERT_OR_UPDATE">
        <active>true</active>
        <admin_overrides>true</admin_overrides>
        <advanced>true</advanced>
        <applies_to/>
        <condition/>
        <controlled_by_refs/>
        <decision_type>allow</decision_type>
        <description>Allow create for records in x_snc_mock_skillup_certificado, for users with roles (x_snc_mock_skillup.admin, x_snc_mock_skillup.colaborador, x_snc_mock_skillup.gestor, admin), and if the ACL script returns true.</description>
        <local_or_existing>Local</local_or_existing>
        <name>x_snc_mock_skillup_certificado</name>
        <operation display_value="create">create</operation>
        <script><![CDATA[// Permite: admin/app_admin/gestor; colaborador só no que é dele.
(function () {
  function is(role){ return gs.hasRole(role); }
  if (is('admin') || is('x_snc_mock_skillup.admin') || is('x_snc_mock_skillup.gestor')) { answer = true; return; }

  if (!gs.hasRole('x_snc_mock_skillup.colaborador')) { answer = false; return; }
  try {
    if (!current || !current.isValidField('colaborador')) { answer = false; return; }

    var meId = gs.getUserID() || '';
    var meEmail = (gs.getUser().getEmail() || '').toLowerCase();
    var gr = new GlideRecord('x_snc_mock_skillup_colaborador');
    var qc = gr.addQuery('usuario', meId);
    if (meEmail) qc.addOrCondition('email', meEmail);
    gr.setLimit(1); gr.query();

    var myColab = gr.next() ? ('' + gr.getUniqueValue()) : '';
    var recColab = '' + current.getValue('colaborador');
    answer = !!(myColab && recColab && myColab === recColab);
  } catch (e) { answer = false; }
})();

]]></script>
        <security_attribute/>
        <sys_class_name>sys_security_acl</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2025-09-04 17:38:54</sys_created_on>
        <sys_id>93ebf291c3ffa2104d7636dc050131f2</sys_id>
        <sys_mod_count>2</sys_mod_count>
        <sys_name>x_snc_mock_skillup_certificado</sys_name>
        <sys_package display_value=" Mock SkillUp" source="x_snc_mock_skillup">389364c69f9322107f44bcf72024ab3f</sys_package>
        <sys_policy/>
        <sys_scope display_value=" Mock SkillUp">389364c69f9322107f44bcf72024ab3f</sys_scope>
        <sys_update_name>sys_security_acl_93ebf291c3ffa2104d7636dc050131f2</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2025-09-04 22:54:23</sys_updated_on>
        <type display_value="record">record</type>
    </sys_security_acl>
</record_update>
